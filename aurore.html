<section class="sujet">
  <h2>ğŸŒŒ PrÃ©vision des Aurores</h2>
  <p id="kp-index">Chargement des donnÃ©es NOAA...</p>
  <p id="kp-message"></p>
  <p style="font-size: 0.9em; color: #777;">DonnÃ©es fournies par NOAA Space Weather Prediction Center</p>
</section>

<script>
  fetch('https://services.swpc.noaa.gov/json/planetary_k_index.json')
    .then(res => res.json())
    .then(data => {
      const last = data[data.length - 1];
      const kp = parseFloat(last.kp_index);
      const time = new Date(last.time_tag).toLocaleString('fr-CA', {
        weekday: 'long',
        hour: '2-digit',
        minute: '2-digit'
      });

      document.getElementById('kp-index').innerText = `ğŸ“¡ Indice KP actuel : ${kp} (mesurÃ© ${time})`;

      let message = '';
      if (kp < 3) {
        message = "ğŸ§Š Aucune chance d'aurores Ã  votre latitude.";
      } else if (kp < 5) {
        message = "âœ¨ Faible chance dâ€™aurores borÃ©ales dans le nord du QuÃ©bec.";
      } else if (kp >= 5 && kp < 7) {
        message = "ğŸŒ  ProbabilitÃ© Ã©levÃ©e dâ€™aurores dans le nord du Canada.";
      } else if (kp >= 7) {
        message = "ğŸ”¥ TempÃªte gÃ©omagnÃ©tique ! Aurores possibles jusquâ€™au sud du QuÃ©bec.";
      }

      document.getElementById('kp-message').innerText = message;
    })
    .catch(err => {
      document.getElementById('kp-index').innerText = "âŒ Impossible de rÃ©cupÃ©rer les donnÃ©es KP.";
      console.error(err);
    });
</script>
