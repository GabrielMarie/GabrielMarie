<!DOCTYPE html>
<html lang="fr">
<head>
<title>Site de Gabriel Marie – explorateur, mathématicien et auteur</title>
<meta name="description" content="Site personnel de Gabriel Marie, explorateur, mathématicien et auteur.">
<meta name="keywords" content="Lac Debor, Lac Nipisso, Debor, Nipisso, le site de Gab, lesitedegab, LeSiteDeGab, Griel Marie, Gabriel Lavoie-St-Gelais, Lavoie-St-Gelais, St-Gelais, mathématiques, math, mathématique, mathématiques avancées, analyse réelle, blog math, projet de maîtrise, projet de baccalauréat, physique et math, intégrabilité de Riemann, convergence quasi-uniforme, convergence presque partout, convergence uniforme, inégalité de Hardy, inégalités de Hardy, inégalités de Hardy multipartielles, inégalité de Hardy multi-particules, multi-particle Hardy inequality, multi-particle Hardy inequalities, Hardy inequality for multiple particles, Hardy inequalities in RdN, Hardy inequality in ℝ^dN, Hardy inequalities for many-body systems, quasi-uniform convergence, almost everywhere convergence, uniform convergence, restricted relativity, relativité restreinte, théorie de la relativité, master's project in mathematics, bachelor project in physics, real analysis, Riemann integrability, convergence of functions, mathematical blog, advanced mathematics, math research project, mathematical physics, Gabriel Marie explorer, théorie mathématique, fonctions réelles, suite de fonctions, séries de fonctions, mathématiques appliquées, calcul différentiel, calcul intégral">
<meta name="author" content="Gabriel Marie">


<noscript> 
    <section>
        <h2>Mathématiques</h2>
        <p>Projets sur la convergence quasi-uniforme, les inégalités de Hardy, et la relativité restreinte.</p>
    </section>

    <section>
        <h2>Capitaine Walker</h2>
        <p>Un projet de fiction inspiré par le personnage du Capitaine Walker, explorant des thèmes de voyage et d'aventure.</p>
    </section>

    <section>
        <h2>Expéditions</h2>
        <p>Je documente ici mes expéditions en solitaire sur la Côte-Nord, à la recherche de cratères de météorites, de formations géologiques rares et de traces culturelles autochtones.</p>
    </section>
</noscript>




    <meta name="google-site-verification" content="Dq94yXL9JZZ3f74GppVq-q8T28y6s25D9_e8K5RJ7b4" />
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans&display=swap" rel="stylesheet">
    <meta charset="UTF-8"> 
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Mon Site</title>
    
    <!-- Lien vers la feuille de style CSS -->
    <link rel="stylesheet" href="style.css">
    <!-- Script MathJax -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/javascript">
        window.MathJax = {
          tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']], // Autoriser $...$ et \( ... \)
            displayMath: [['$$', '$$'], ['\\[', '\\]']] // Autoriser $$...$$ et \[ ... \]
          }
        };








        






    </script>
</head>
<body>
    <script src="script.js"></script>

    <!-- En-tête contenant la bannière et le menu de navigation -->
    <header>
    <div class="banner">
        <img id="siteBanner" >
        <!-- Bouton menu burger (visible sur mobile) -->
        <div class="menu-toggle" onclick="toggleMenu()">☰</div>
    </div>

    <!-- Menu navigation avec ID pour JS -->
    <nav id="menu">
        <ul>
            <li><a href="home.html"> <span class="pixel-gab">Accueil</span></a></li>
            <li><a href="math.html"><span class="pixel-gab">math </span></a></li>
            <li><a href="walker.html"><span class="pixel-gab">CAPITAINE&nbsp;Walker</span></a></li>
            <li><a href="expedition.html"><span class="pixel-gab">ExpEdition</span></a></li>
            <li><a href="securitephysique.html"><span class="pixel-gab">Securite</span></a></li>
            <li><a href="aurore.html"><span class="pixel-gab">Aurore</span></a></li>
            <li><a href="dessin.html"><span class="pixel-gab">Dessin</span></a></li>                                  
            <li><a href="contact.html"><span class="pixel-gab">Contact</span></a></li>
        </ul>
    </nav>
</header>



   
    
    <!-- Contenu principal -->
    <main>
        <div id="content"> 
       
        </div>
    </main>

    <!-- Image cliquable qui déclenche une animation -->
    <img id="easter-egg" src="oeufstat.png" alt="Œuf de Pâques" onclick="triggerGif()">

    <!-- Script pour changer l'image en un GIF temporairement -->
    <script>
        function triggerGif() {
            let egg = document.getElementById("easter-egg");
            let staticImg = "oeufstat.png"; // Image statique de l'œuf
            let gifImg = "oeuf.gif";    // GIF à afficher

            egg.src = gifImg; // Change l'image statique en GIF

            // Après un délai, remettre l'image statique
            setTimeout(() => {
                egg.style.display = "none";
                egg.style.pointerEvents = "none";
            }, 10290); // Revient à l'image statique après 2 secondes
        }
    </script>

   
<script>




    function navigate(event, page) {
        event.preventDefault(); 
        loadPage(page);
        history.pushState({ page: page }, "", "#" + page); 
    }



    window.onpopstate = function (e) {
        if (e.state && e.state.page) {
            loadPage(e.state.page);
        }
    };

    document.addEventListener("DOMContentLoaded", () => {
        let hash = window.location.hash.slice(1);
        let page = (hash && hash.endsWith(".html")) ? hash : "home.html";
        loadPage(page);

        let banner = document.getElementById("siteBanner");
        if (banner) {
            banner.src = "le site de gab.gif";
            setTimeout(() => banner.src = "le site de gab fin.gif", 6000);
        }

        document.querySelectorAll("nav a").forEach(link => {
            const href = link.getAttribute("href");
            link.addEventListener("click", event => navigate(event, href));
        });
    });

</script>



<script>
    function toggleMenu() {
        const menu = document.getElementById("menu");
        menu.classList.toggle("active");
    }
</script>





<script>
let currentIndex = 0;
let isTransitioning = false;

function updateVisibleEntry() {
  if (isTransitioning) return;

  const entries = document.querySelectorAll("#journal-entry .entry");
  const previous = document.querySelector(".entry.active");

  if (previous) {
    isTransitioning = true;
    previous.classList.remove("active");
    previous.style.opacity = 0;

    setTimeout(() => {
      previous.style.display = "none";

      const next = entries[currentIndex];
      next.style.display = "block";
      setTimeout(() => {
        next.classList.add("active");
        next.style.opacity = 1;
        isTransitioning = false;

        // Scroll automatique en haut de la nouvelle entrée
        next.scrollIntoView({ behavior: "smooth", block: "start" });
      }, 10);
    }, 300);
  }

  const indicator = document.getElementById("page-indicator");
  if (indicator) {
    indicator.textContent = `${currentIndex + 1} / ${entries.length}`;
  }
}


function nextEntry() {
  const entries = document.querySelectorAll("#journal-entry .entry");
  if (currentIndex < entries.length - 1) {
    currentIndex++;
    updateVisibleEntry();
  }
}

function previousEntry() {
  if (currentIndex > 0) {
    currentIndex--;
    updateVisibleEntry();
  }
}

document.addEventListener("DOMContentLoaded", () => {
  const entries = document.querySelectorAll("#journal-entry .entry");
  entries.forEach((entry, i) => {
    entry.style.opacity = 0;
    entry.style.display = "none";
  });
  const first = entries[0];
  first.style.display = "block";
  setTimeout(() => {
    first.classList.add("active");
    first.style.opacity = 1;
  }, 10);
});
</script>





<!-- Chart.js pour les graphiques -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>



<script>
function loadPage(page) {
  const oldWalker = document.querySelector(".walker-sommaire");
  if (oldWalker) oldWalker.remove();
    fetch(page)
        .then(res => res.text())
        .then(html => {
            document.getElementById('content').innerHTML = '';
            document.getElementById('content').innerHTML = html;
if (page.includes("walker")) {
  // Important : attendre que le DOM soit mis à jour
  requestAnimationFrame(() => {
    const old = document.querySelector(".walker-sommaire");
    if (old) old.remove(); // Supprime l’ancien sommaire s’il existe

    const sujetSections = document.querySelectorAll(".sujet[id^='sujet']");
    if (sujetSections.length > 0) {
      const sommaire = document.createElement("section");
      sommaire.className = "walker-sommaire";
const titre = document.createElement("h2");
titre.textContent = "Sommaire";
titre.className = "titre-sommaire"; // Optionnel pour styliser
sommaire.appendChild(titre);
const liste = document.createElement("ul");

const ul = document.createElement("ul");
sommaire.appendChild(ul);


      sujetSections.forEach(section => {
        const titreEl = section.querySelector("h2");
        const titre = titreEl ? titreEl.textContent.trim() : "Extrait";
        const id = section.id;

        const li = document.createElement("li");
        li.innerHTML = `<a href="#${id}">${titre}</a>`;
        ul.appendChild(li);
      });

// ➤ C’est ici qu’on insère le sommaire à l’endroit voulu
      const insertionPoint = document.querySelector("#insertion-sommaire");
      if (insertionPoint) {
        insertionPoint.replaceWith(sommaire);
      } else {
        // fallback au cas où
        const main = document.querySelector("main");
        main.insertBefore(sommaire, main.firstChild);
}

    }
  });
}




if (page.includes("expedition")) {
  requestAnimationFrame(() => {
    const old = document.querySelector(".expedition-sommaire");
    if (old) old.remove();

    // On sélectionne tous les <h2> contenant "Expédition"
    const titres = Array.from(document.querySelectorAll("h2"))
      .filter(h => h.textContent.includes("Expédition"));

    if (titres.length > 0) {
      const sommaire = document.createElement("section");
      sommaire.className = "expedition-sommaire";

      const titre = document.createElement("h2");
      titre.textContent = "Sommaire des expéditions";
      sommaire.appendChild(titre);

      const ul = document.createElement("ul");

      titres.forEach((h, index) => {
        // Génère un id s'il n'existe pas
        if (!h.id) {
          h.id = "expedition-" + index;
        }

        const li = document.createElement("li");
        li.innerHTML = `<a href="#${h.id}">${h.textContent.trim()}</a>`;
        ul.appendChild(li);
      });

      sommaire.appendChild(ul);

      const insertionPoint = document.querySelector("#insertion-sommaire-expedition");
      if (insertionPoint) {
        insertionPoint.replaceWith(sommaire);
      }
    }
  });
}




                if (page.includes("dessin.html")) {
                const galerie = document.querySelector("#galerie-dessins");
                if (!galerie) return;
                

                const entries = Array.from(document.querySelectorAll(".dessin-entry"));
                entries.sort((a, b) => new Date(b.dataset.date) - new Date(a.dataset.date));
                entries.forEach((entry, i) => {
                    entry.classList.add(i % 2 === 0 ? 'left' : 'right');
                    galerie.appendChild(entry);
                });

                // Ajoute une légende expliquant l’ordre d’affichage
                
                // Génère un sommaire cliquable
                // Génère une légende cliquable avec titres et dates
                const legende = document.createElement("div");
                legende.className = "dessin-legende dessin-sommaire";
                let contenu = "<strong style='display:block; margin-bottom:0.5em;'>🖼️ Sommaire des dessins</strong><ul>";

                entries.forEach((entry, i) => {
                  const titre = entry.querySelector("h2")?.textContent || `Dessin ${i + 1}`;
                  const date = entry.dataset.date || "Sans date";
                  const ancre = `dessin-${i}`;
                  entry.id = ancre;

                  contenu += `<li><a href="#${ancre}"><span class="date">${date}</span> — <span class="titre">${titre}</span></a></li>`;
                });

                contenu += "</ul>";
                legende.innerHTML = contenu;

                // Insère la légende à gauche du conteneur galerie
                galerie.insertAdjacentElement("beforebegin", legende);

                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(e => {
                        if (e.isIntersecting) {
                            e.target.classList.add('visible');
                            observer.unobserve(e.target);
                        }
                    });
                }, { threshold: 0.1 });

                document.querySelectorAll(".dessin-entry").forEach(e => observer.observe(e));
            }


            if (window.MathJax) MathJax.typesetPromise();

            // Si on vient de charger aurore.html, alors exécute manuellement le fetch
            if (page.includes("aurore.html")) {
              fetch("https://muddy-cell-637b.gabriel-saint-gelais.workers.dev/?url=https://services.swpc.noaa.gov/json/planetary_k_index.json")
  .then(res => res.json())
  .then(kpHourly => {
    const graphContainer = document.createElement("div");
    graphContainer.style.marginTop = "1em";

    const canvas = document.createElement("canvas");
    canvas.id = "kp-forecast-chart";
    graphContainer.appendChild(canvas);

    kpMessage.insertAdjacentElement("afterend", graphContainer);

    const times = kpHourly.map(entry =>
      new Date(entry.time_tag).toLocaleString(undefined, {
        hour: '2-digit',
        day: '2-digit',
        month: '2-digit'
      })
    );
    const values = kpHourly.map(entry => parseFloat(entry.kp_index));

    new Chart(canvas, {
      type: 'bar',
      data: {
        labels: times,
        datasets: [{
          label: 'Prévision KP (3h)',
          data: values,
          backgroundColor: values.map(kp => {
            if (kp < 3) return '#1e90ff';
            if (kp < 5) return '#4caf50';
            if (kp < 7) return '#ff9800';
            return '#f44336';
          })
        }]
      },
      options: {
        scales: {
          y: {
            min: 0,
            max: 9,
            ticks: { stepSize: 1 }
          }
        },
        plugins: {
          legend: { display: false }
        }
      }
    });
  })
  .catch(err => {
    console.warn("Erreur lors du chargement des prévisions KP :", err);
  });

              fetch("https://muddy-cell-637b.gabriel-saint-gelais.workers.dev/?url=https://services.swpc.noaa.gov/json/planetary_k_index.json")
  .then(res => res.json())
  .then(kpHourly => {
    const graphContainer = document.createElement("div");
    graphContainer.style.marginTop = "1em";

    const canvas = document.createElement("canvas");
    canvas.id = "kp-forecast-chart";
    graphContainer.appendChild(canvas);

    kpMessage.insertAdjacentElement("afterend", graphContainer);

    const times = kpHourly.map(entry =>
      new Date(entry.time_tag).toLocaleString(undefined, {
        hour: '2-digit',
        day: '2-digit',
        month: '2-digit'
      })
    );
    const values = kpHourly.map(entry => parseFloat(entry.kp_index));

    // Nécessite Chart.js !
    new Chart(canvas, {
      type: 'bar',
      data: {
        labels: times,
        datasets: [{
          label: 'Prévision KP (3h)',
          data: values
        }]
      },
      options: {
        scales: {
          y: { min: 0, max: 9 }
        },
        plugins: {
          legend: { display: false }
        }
      }
    });
  })
  .catch(err => {
    console.warn("Erreur lors du chargement des prévisions KP :", err);
  });






  
                const kpIndex = document.getElementById("kp-index");
                const kpMessage = document.getElementById("kp-message");

                if (kpIndex && kpMessage) {
                    kpIndex.innerText = "Chargement des données NOAA...";

                    fetch("https://muddy-cell-637b.gabriel-saint-gelais.workers.dev/?url=https://services.swpc.noaa.gov/json/planetary_k_index_1m.json")
                        .then(res => res.json())
                        .then(data => {
                            const last = data[data.length - 1];
                            const kp = parseFloat(last.kp_index);
                            const time = new Date(last.time_tag).toLocaleString('fr-CA', {
                                weekday: 'long',
                                hour: '2-digit',
                                minute: '2-digit'
                            });

                            kpIndex.innerText = `📡 Indice KP minute : ${kp} (mesuré ${time} UTC )`;

                            let message = '';
                            if (kp < 3) {
                                message = "🧊 Aucune chance d'aurores à votre latitude.";
                            } else if (kp < 5) {
                                message = "✨ Faible chance d’aurores boréales dans le nord du Québec.";
                            } else if (kp >= 5 && kp < 7) {
                                message = "🌠 Probabilité élevée d’aurores dans le nord du Canada.";
                            } else if (kp >= 7) {
                                message = "🔥 Tempête géomagnétique ! Aurores possibles jusqu’au sud du Québec.";
                            }

                            kpMessage.innerText = message;
                        })
                        .catch(err => {
                            kpIndex.innerText = "❌ Impossible de récupérer les données KP.";
                            console.error(err);
                        });
                }
            }
        });
}



</script>


</body>
</html>
